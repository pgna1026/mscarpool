<!doctype html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>마송고 카풀 서비스</title>
    <style>
        .hidden { display: none; }
    </style>
</head>
<body>
    <h1>마송고 카풀 서비스</h1>

    <button id="hostButton">호스트</button>
    <div id="hostForm" class="hidden">
        <input type="text" id="roomName" placeholder="방 이름">
        <button id="createRoom">방 만들기</button>
    </div>

    <input type="text" id="searchInput" placeholder="방 이름 검색">
    <div id="roomLinks"></div>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const hostButton = document.getElementById('hostButton');
            const hostForm = document.getElementById('hostForm');
            const createRoomButton = document.getElementById('createRoom');
            const roomNameInput = document.getElementById('roomName');
            const searchInput = document.getElementById('searchInput');
            const roomLinksDiv = document.getElementById('roomLinks');

            hostButton.addEventListener('click', function() {
                hostForm.classList.toggle('hidden');
            });

            createRoomButton.addEventListener('click', function() {
                const roomName = roomNameInput.value.trim();
                if (roomName) {
                    addRoom(roomName);
                    roomNameInput.value = '';
                }
            });

            searchInput.addEventListener('input', function() {
                updateSearch();
            });

            function loadRooms() {
                const rooms = JSON.parse(localStorage.getItem('rooms') || '[]');
                rooms.forEach(room => {
                    createRoomLink(room);
                });
                updateSearch();
            }

            function saveRooms(rooms) {
                localStorage.setItem('rooms', JSON.stringify(rooms));
            }

            function addRoom(roomName) {
                const rooms = JSON.parse(localStorage.getItem('rooms') || '[]');
                if (!rooms.includes(roomName)) {
                    rooms.push(roomName);
                    saveRooms(rooms);
                    createRoomLink(roomName);
                    updateSearch();
                }
            }

            function createRoomLink(roomName) {
                const roomLink = document.createElement('a');
                roomLink.href = `room.html?room=${encodeURIComponent(roomName)}`;
                roomLink.className = 'roomLink';
                roomLink.textContent = `채팅방: ${roomName}`;
                roomLinksDiv.appendChild(roomLink);
                roomLinksDiv.appendChild(document.createElement('br'));
            }

            function updateSearch() {
                const searchQuery = searchInput.value.toLowerCase();
                document.querySelectorAll('.roomLink').forEach(link => {
                    const roomName = link.textContent.toLowerCase();
                    if (roomName.includes(searchQuery)) {
                        link.style.display = '';
                    } else {
                        link.style.display = 'none';
                    }
                });
            }

            loadRooms();
        });
    </script>
</body>
</html>
